# ip of mqtt brokers

- 192.168.2.1
- 192.168.3.1
- 192.168.0.4

# legitimate MQTT traffic

450 sensors

ip 192.168.18.10-234 and 192.168.19.10-234

| ip mqtt broker dst     | nb of distinct publishers | ip range                             | 
|------------------------|---------------------------|--------------------------------------|
| 192.168.2.1 anon Clear | 225                       | 192.168.18.10-234                    | 
| 192.168.3.1 auth Clear | 103                       | 192.168.19.10-113                    | 
| 192.168.0.4 anon TLS   | 122                       | 192.168.19.54 and 192.168.19.114-234 | 

# compromised IoT launching DDoS

337 distinct ips

- 192.168.18.10 
- 192.168.18.100 
- 192.168.18.103 
- 192.168.18.104 
- 192.168.18.105 
- 192.168.18.106 
- 192.168.18.108 
- 192.168.18.109 
- 192.168.18.11 
- 192.168.18.110 
- 192.168.18.111 
- 192.168.18.112 
- 192.168.18.113 
- 192.168.18.114 
- 192.168.18.115 
- 192.168.18.117 
- 192.168.18.119 
- 192.168.18.12 
- 192.168.18.120 
- 192.168.18.121 
- 192.168.18.122 
- 192.168.18.123 
- 192.168.18.124 
- 192.168.18.125 
- 192.168.18.126 
- 192.168.18.127 
- 192.168.18.128 
- 192.168.18.129 
- 192.168.18.13 
- 192.168.18.130 
- 192.168.18.131 
- 192.168.18.132 
- 192.168.18.133 
- 192.168.18.134 
- 192.168.18.135 
- 192.168.18.136 
- 192.168.18.137 
- 192.168.18.138 
- 192.168.18.14 
- 192.168.18.140 
- 192.168.18.141 
- 192.168.18.143 
- 192.168.18.144 
- 192.168.18.146 
- 192.168.18.147 
- 192.168.18.148 
- 192.168.18.149 
- 192.168.18.15 
- 192.168.18.151 
- 192.168.18.158 
- 192.168.18.159 
- 192.168.18.16 
- 192.168.18.160 
- 192.168.18.161 
- 192.168.18.163 
- 192.168.18.164 
- 192.168.18.165 
- 192.168.18.166 
- 192.168.18.167 
- 192.168.18.168 
- 192.168.18.17 
- 192.168.18.170 
- 192.168.18.172 
- 192.168.18.174 
- 192.168.18.175 
- 192.168.18.176 
- 192.168.18.177 
- 192.168.18.178 
- 192.168.18.18 
- 192.168.18.180 
- 192.168.18.181 
- 192.168.18.183 
- 192.168.18.184 
- 192.168.18.185 
- 192.168.18.186 
- 192.168.18.188 
- 192.168.18.189 
- 192.168.18.19 
- 192.168.18.190 
- 192.168.18.191 
- 192.168.18.192 
- 192.168.18.193 
- 192.168.18.196 
- 192.168.18.197 
- 192.168.18.198 
- 192.168.18.199 
- 192.168.18.20 
- 192.168.18.204 
- 192.168.18.205 
- 192.168.18.208 
- 192.168.18.209 
- 192.168.18.210 
- 192.168.18.211 
- 192.168.18.212 
- 192.168.18.213 
- 192.168.18.215 
- 192.168.18.216 
- 192.168.18.217 
- 192.168.18.218 
- 192.168.18.220 
- 192.168.18.221 
- 192.168.18.222 
- 192.168.18.223 
- 192.168.18.227 
- 192.168.18.229 
- 192.168.18.23 
- 192.168.18.230 
- 192.168.18.231 
- 192.168.18.232 
- 192.168.18.233 
- 192.168.18.234 
- 192.168.18.25 
- 192.168.18.27 
- 192.168.18.28 
- 192.168.18.29 
- 192.168.18.30 
- 192.168.18.31 
- 192.168.18.34 
- 192.168.18.35 
- 192.168.18.36 
- 192.168.18.38 
- 192.168.18.42 
- 192.168.18.44 
- 192.168.18.45 
- 192.168.18.46 
- 192.168.18.47 
- 192.168.18.48 
- 192.168.18.51 
- 192.168.18.52 
- 192.168.18.53 
- 192.168.18.54 
- 192.168.18.55 
- 192.168.18.56 
- 192.168.18.57 
- 192.168.18.58 
- 192.168.18.59 
- 192.168.18.60 
- 192.168.18.61
- 192.168.18.62 
- 192.168.18.63 
- 192.168.18.64 
- 192.168.18.65 
- 192.168.18.66 
- 192.168.18.69 
- 192.168.18.72 
- 192.168.18.73 
- 192.168.18.74 
- 192.168.18.75 
- 192.168.18.76 
- 192.168.18.77 
- 192.168.18.78 
- 192.168.18.79 
- 192.168.18.80 
- 192.168.18.81 
- 192.168.18.82 
- 192.168.18.83 
- 192.168.18.85 
- 192.168.18.86 
- 192.168.18.87 
- 192.168.18.88 
- 192.168.18.89 
- 192.168.18.90 
- 192.168.18.91 
- 192.168.18.93 
- 192.168.18.96 
- 192.168.18.98 
- 192.168.18.99 
- 192.168.19.100 
- 192.168.19.101 
- 192.168.19.102 
- 192.168.19.104 
- 192.168.19.105 
- 192.168.19.106 
- 192.168.19.107 
- 192.168.19.108 
- 192.168.19.109 
- 192.168.19.110 
- 192.168.19.111 
- 192.168.19.112 
- 192.168.19.113 
- 192.168.19.114 
- 192.168.19.115 
- 192.168.19.116 
- 192.168.19.117 
- 192.168.19.118 
- 192.168.19.119 
- 192.168.19.12 
- 192.168.19.121 
- 192.168.19.123 
- 192.168.19.124 
- 192.168.19.126 
- 192.168.19.127 
- 192.168.19.128 
- 192.168.19.129 
- 192.168.19.13 
- 192.168.19.130 
- 192.168.19.132 
- 192.168.19.133 
- 192.168.19.134 
- 192.168.19.135 
- 192.168.19.136 
- 192.168.19.137 
- 192.168.19.14 
- 192.168.19.141 
- 192.168.19.142 
- 192.168.19.143 
- 192.168.19.144 
- 192.168.19.145 
- 192.168.19.147 
- 192.168.19.148 
- 192.168.19.149 
- 192.168.19.15 
- 192.168.19.150 
- 192.168.19.151 
- 192.168.19.152 
- 192.168.19.153 
- 192.168.19.154 
- 192.168.19.157 
- 192.168.19.158 
- 192.168.19.159 
- 192.168.19.16 
- 192.168.19.160 
- 192.168.19.161 
- 192.168.19.163 
- 192.168.19.164 
- 192.168.19.165 
- 192.168.19.166 
- 192.168.19.167 
- 192.168.19.168 
- 192.168.19.170 
- 192.168.19.171 
- 192.168.19.172 
- 192.168.19.173 
- 192.168.19.176 
- 192.168.19.177 
- 192.168.19.178 
- 192.168.19.179 
- 192.168.19.18 
- 192.168.19.180 
- 192.168.19.182 
- 192.168.19.184 
- 192.168.19.185 
- 192.168.19.186 
- 192.168.19.187 
- 192.168.19.188 
- 192.168.19.189 
- 192.168.19.19 
- 192.168.19.190 
- 192.168.19.191 
- 192.168.19.192 
- 192.168.19.193 
- 192.168.19.194 
- 192.168.19.195 
- 192.168.19.196 
- 192.168.19.197 
- 192.168.19.199 
- 192.168.19.20 
- 192.168.19.200 
- 192.168.19.201 
- 192.168.19.202 
- 192.168.19.203 
- 192.168.19.204 
- 192.168.19.205 
- 192.168.19.207 
- 192.168.19.209 
- 192.168.19.21 
- 192.168.19.210 
- 192.168.19.213 
- 192.168.19.214 
- 192.168.19.22 
- 192.168.19.220 
- 192.168.19.222 
- 192.168.19.224 
- 192.168.19.225 
- 192.168.19.226 
- 192.168.19.227 
- 192.168.19.228 
- 192.168.19.229 
- 192.168.19.23 
- 192.168.19.230 
- 192.168.19.231 
- 192.168.19.232 
- 192.168.19.233 
- 192.168.19.234 
- 192.168.19.24 
- 192.168.19.25 
- 192.168.19.26 
- 192.168.19.30 
- 192.168.19.31 
- 192.168.19.32 
- 192.168.19.33 
- 192.168.19.35 
- 192.168.19.36 
- 192.168.19.37 
- 192.168.19.38 
- 192.168.19.39 
- 192.168.19.40 
- 192.168.19.41 
- 192.168.19.43 
- 192.168.19.44 
- 192.168.19.46 
- 192.168.19.47 
- 192.168.19.48 
- 192.168.19.50 
- 192.168.19.51 
- 192.168.19.52 
- 192.168.19.53 
- 192.168.19.55 
- 192.168.19.56 
- 192.168.19.57 
- 192.168.19.59 
- 192.168.19.60 
- 192.168.19.62 
- 192.168.19.64 
- 192.168.19.67 
- 192.168.19.69 
- 192.168.19.71 
- 192.168.19.73 
- 192.168.19.76 
- 192.168.19.77 
- 192.168.19.78 
- 192.168.19.79 
- 192.168.19.80 
- 192.168.19.81 
- 192.168.19.83 
- 192.168.19.84 
- 192.168.19.85 
- 192.168.19.86 
- 192.168.19.87 
- 192.168.19.89 
- 192.168.19.91 
- 192.168.19.92 
- 192.168.19.93 
- 192.168.19.94 
- 192.168.19.95 
- 192.168.19.96 
- 192.168.19.97 



# command executed by compromised IoT

mqttsa -fc 100 -fcsize 10 -sc 2400 192.168.2.1

# statistics on pcap files

using `capinfos <filename>`
```text
File name:           OpenvSwitch-24_2-0_to_sinetstream-zookeeper-1_0-0.pcap
File type:           Wireshark/tcpdump/... - pcap
File encapsulation:  Ethernet
File timestamp precision:  microseconds (6)
Packet size limit:   file hdr: 65535 bytes
Number of packets:   1,498
File size:           215 kB
Data size:           191 kB
Capture duration:    1844.451407 seconds
First packet time:   2024-04-12 23:54:19.922952
Last packet time:    2024-04-13 00:25:04.374359
Data byte rate:      103 bytes/s
Data bit rate:       830 bits/s
Average packet size: 127.78 bytes
Average packet rate: 0 packets/s
SHA256:              564a268c596604e166f60be79fe147af5d0a79196f3391c80fa5c051f5ef2dcf
RIPEMD160:           2da8dad8b8ea9be811be1c05840a094aefdc0dd8
SHA1:                06ca0f2a238f05b4234207a56f5c2273f347fcfc
Strict time order:   True
Number of interfaces in file: 1
Interface #0 info:
                     Encapsulation = Ethernet (1 - ether)
                     Capture length = 65535
                     Time precision = microseconds (6)
                     Time ticks per second = 1000000
                     Number of stat entries = 0
                     Number of packets = 1498
```
```
File name:           OpenvSwitch-24_4-0_to_sinetstream-connect-kafka-1_0-0.pcap
File type:           Wireshark/tcpdump/... - pcap
File encapsulation:  Ethernet
File timestamp precision:  microseconds (6)
Packet size limit:   file hdr: 65535 bytes
Number of packets:   418 k
File size:           103 MB
Data size:           96 MB
Capture duration:    1845.186491 seconds
First packet time:   2024-04-12 23:54:20.012846
Last packet time:    2024-04-13 00:25:05.199337
Data byte rate:      52 kBps
Data bit rate:       418 kbps
Average packet size: 230.13 bytes
Average packet rate: 227 packets/s
SHA256:              c339fa5f26927d190b8122b59ca8a58b326aad6ef11b61dbf06aeea81ca8711a
RIPEMD160:           b26d39cf847f5d9ed94fa145d326754b24425538
SHA1:                af6ffd348a90981682f232e6569aa917aca48300
Strict time order:   False
Number of interfaces in file: 1
Interface #0 info:
                     Encapsulation = Ethernet (1 - ether)
                     Capture length = 65535
                     Time precision = microseconds (6)
                     Time ticks per second = 1000000
                     Number of stat entries = 0
                     Number of packets = 418964
```
```
File name:           VyOS130-1_1-0_to_VyOS130-2_1-0.pcap
File type:           Wireshark/tcpdump/... - pcap
File encapsulation:  Ethernet
File timestamp precision:  microseconds (6)
Packet size limit:   file hdr: 65535 bytes
Number of packets:   7,718 k
File size:           1,188 MB
Data size:           1,065 MB
Capture duration:    1846.344645 seconds
First packet time:   2024-04-12 23:54:16.871163
Last packet time:    2024-04-13 00:25:03.215808
Data byte rate:      577 kBps
Data bit rate:       4,616 kbps
Average packet size: 138.05 bytes
Average packet rate: 4,180 packets/s
SHA256:              e534b5222062fc2b549b62259fa9de83cc00245b15b0c40cfac8aa413a9df814
RIPEMD160:           839055a7d191e1b20e0f9c8eb330da63f5136bd9
SHA1:                4c3bc51d4e50071f34caddee3c54b797e484fdcf
Strict time order:   False
Number of interfaces in file: 1
Interface #0 info:
                     Encapsulation = Ethernet (1 - ether)
                     Capture length = 65535
                     Time precision = microseconds (6)
                     Time ticks per second = 1000000
                     Number of stat entries = 0
                     Number of packets = 7718077
```